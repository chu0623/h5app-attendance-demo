(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{134:function(e,t,a){},273:function(e,t,a){},615:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(29),c=a.n(s),r=(a(273),a(9)),d=a(11),o=a(12),l=a(13),u=(a(134),a(174)),h=a(53),j=a.n(h),m=a(197),f=a(37),b=a.n(f),p=a(7),O=a(617),x=a(618),y=a(67),g=a(5),v=function(e){var t=O.a.useForm(),a=Object(p.a)(t,1)[0],i=Object(n.useState)(!1),s=Object(p.a)(i,2),c=(s[0],s[1],Object(n.useState)(null)),r=Object(p.a)(c,2);r[0],r[1],new Date;return Object(g.jsxs)("div",{children:[Object(g.jsxs)("h4",{className:"title",children:["\u8003\u52e4\u6a21\u5757\u2014\u2014",e.title]}),Object(g.jsxs)(O.a,{form:a,onFinish:function(t){e.onClick(t)},initialValues:{name:"\u5c0f\u767d\u8003\u52e4\u6d4b\u8bd5\u4e00\u7ec4",title:"\u9752\u85cf\u9ad8\u539f\u81ea\u7136\u535a\u7269\u9986",address:"\u751f\u7269\u79d1\u6280\u4ea7\u4e1a\u56ed\u533a\u7ecf\u4e8c\u8def21\u53f7",latitude:"36.687495",longitude:"101.750329"},children:[Object(g.jsx)(O.a.Item,{label:"\u8003\u52e4\u7ec4\u540d\u79f0",name:"name",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8003\u52e4\u7ec4\u540d\u79f0"})}),Object(g.jsx)(O.a.Item,{label:"\u8003\u52e4\u6807\u9898",name:"title",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8003\u52e4\u6807\u9898"})}),Object(g.jsx)(O.a.Item,{label:"\u8003\u52e4\u5730\u5740",name:"address",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8003\u52e4\u5730\u5740"})}),Object(g.jsx)(O.a.Item,{label:"\u8003\u52e4\u5730\u5740\u7eac\u5ea6",name:"latitude",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8003\u52e4\u5730\u5740\u7eac\u5ea6"})}),Object(g.jsx)(O.a.Item,{label:"\u8003\u52e4\u5730\u5740\u7ecf\u5ea6",name:"longitude",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u8003\u52e4\u5730\u5740\u7ecf\u5ea6"})}),Object(g.jsx)(m.a,{htmlType:"submit",type:"primary",children:"\u63d0\u4ea4"})]})]})},S=a(3),D=b()().add(1,"days").format("YYYY-MM-DD")+" 08:00:00",I=b()().add(1,"days").format("YYYY-MM-DD")+" 18:00:00",T=function(e){var t=O.a.useForm(),a=Object(p.a)(t,1)[0],i=Object(n.useState)(!1),s=Object(p.a)(i,2),c=s[0],r=s[1],d=Object(n.useState)(!1),o=Object(p.a)(d,2),l=o[0],u=o[1];return Object(g.jsxs)("div",{children:[Object(g.jsxs)("h4",{className:"title",children:["\u8003\u52e4\u6a21\u5757\u2014\u2014",e.title]}),Object(g.jsxs)(O.a,{form:a,onFinish:function(t){var a=Object(S.a)(Object(S.a)({},t),{},{beginTime:b()(t.beginTime).format("YYYY-MM-DD HH:mm:ss"),endTime:b()(t.endTime).format("YYYY-MM-DD HH:mm:ss")});e.onClick(a)},initialValues:{shiftName:"\u5c0f\u767d\u8003\u52e4\u73ed\u6b21\u767d\u73ed",beginTime:new Date(D),endTime:new Date(I)},children:[Object(g.jsx)(O.a.Item,{label:"\u73ed\u6b21\u540d\u79f0",name:"shiftName",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u73ed\u6b21\u540d\u79f0"})}),Object(g.jsx)(O.a.Item,{label:"\u5f00\u59cb\u65f6\u95f4",name:"beginTime",children:Object(g.jsx)(y.a,{visible:c,onClose:function(){r(!1)},min:new Date,precision:"second",onConfirm:function(e,t){a.setFieldsValue({beginTime:e})},children:function(e){return Object(g.jsxs)("div",{style:{textAlign:"left"},children:[Object(g.jsx)(m.a,{onClick:function(){return r(!0)},type:"primary",children:"\u9009\u62e9\u65f6\u95f4"})," ",b()(e).format("YYYY-MM-DD HH:mm:ss")]})}})}),Object(g.jsx)(O.a.Item,{label:"\u7ed3\u675f\u65f6\u95f4",name:"endTime",children:Object(g.jsx)(y.a,{visible:l,onClose:function(){u(!1)},min:new Date,precision:"second",onConfirm:function(e,t){a.setFieldsValue({endTime:e})},children:function(e){return Object(g.jsxs)("div",{style:{textAlign:"left"},children:[Object(g.jsx)(m.a,{onClick:function(){return u(!0)},type:"primary",children:"\u9009\u62e9\u65f6\u95f4"})," ",b()(e).format("YYYY-MM-DD HH:mm:ss")]})}})}),Object(g.jsx)(m.a,{htmlType:"submit",type:"primary",children:"\u63d0\u4ea4"})]})]})},Y=function(e){var t=O.a.useForm(),a=Object(p.a)(t,1)[0],i=Object(n.useState)(!1),s=Object(p.a)(i,2),c=s[0],r=s[1],d=new Date;return Object(g.jsxs)("div",{children:[Object(g.jsxs)("h4",{className:"title",children:["\u8003\u52e4\u6a21\u5757\u2014\u2014",e.title]}),Object(g.jsxs)(O.a,{form:a,onFinish:function(t){var a=Object(S.a)(Object(S.a)({},t),{},{time:b()(t.time).format("YYYY-MM-DD HH:mm:ss")});console.log(a),e.onClick(a)},initialValues:{deviceName:"\u4e1c\u95e8\u6253\u5361\u673a",time:d},children:[Object(g.jsx)(O.a.Item,{label:"\u6253\u5361\u8bbe\u5907\u540d\u79f0",name:"deviceName",children:Object(g.jsx)(x.a,{placeholder:"\u8bf7\u8f93\u5165\u6253\u5361\u8bbe\u5907\u540d\u79f0"})}),Object(g.jsx)(O.a.Item,{label:"\u6253\u5361\u65f6\u95f4",name:"time",children:Object(g.jsx)(y.a,{visible:c,onClose:function(){r(!1)},min:new Date,precision:"second",onConfirm:function(e,t){a.setFieldsValue({time:e})},children:function(e){return Object(g.jsxs)("div",{style:{textAlign:"left"},children:[Object(g.jsx)(m.a,{onClick:function(){return r(!0)},type:"primary",children:"\u9009\u62e9\u65f6\u95f4"})," ",b()(e).format("YYYY-MM-DD HH:mm:ss")]})}})}),Object(g.jsx)(m.a,{htmlType:"submit",type:"primary",children:"\u63d0\u4ea4"})]})]})},N=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={domain:"",corpId:"",authCode:"",userId:"",userName:"",showType:0,groupId:0,shiftId:0,groupData:{positions:[{address:"\u751f\u7269\u79d1\u6280\u4ea7\u4e1a\u56ed\u533a\u7ecf\u4e8c\u8def21\u53f7",latitude:"36.687495",accuracy:"0",title:"\u9752\u85cf\u9ad8\u539f\u81ea\u7136\u535a\u7269\u9986",longitude:"101.750329"}],members:[{role:"Attendance",type:"StaffMember"}],name:"\u767d\u73ed\u8003\u52e4"},shiftData:{classGroupName:"def",shiftName:"\u767d\u73ed",beginTime:"2020-10-18 08:00:00",endTime:"2020-10-18 18:00:00"},scheduleInfo:{schedules:[]},record:{deviceName:"\u4e1c\u95e8\u6253\u5361\u673a",deviceId:1,time:"2021-10-09 09:00:00"},query:{workDateFrom:b()().subtract(7,"days").format("YYYY-MM-DD HH:mm:ss"),workDateTo:b()().format("YYYY-MM-DD HH:mm:ss"),offset:0,limit:50,userIdList:[]},recordList:[],leaveInfo:{startTime:b()().subtract(7,"days").format("YYYY-MM-DD HH:mm:ss"),endTime:b()().format("YYYY-MM-DD HH:mm:ss")},leaveList:[]},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return""===this.state.userId&&this.login(),Object(g.jsxs)("div",{className:"content",children:[Object(g.jsxs)("div",{className:"header",children:[Object(g.jsx)("img",{src:"https://img.alicdn.com/imgextra/i3/O1CN01Mpftes1gwqxuL0ZQE_!!6000000004207-2-tps-240-240.png",className:"headImg",alt:""}),"\u9489\u9489\u6a21\u677f"]}),Object(g.jsxs)("div",{className:"App",children:[0===this.state.showType&&Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)("h2",{children:"\u8003\u52e4\u529f\u80fd\u6f14\u793a"}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.setState({showType:3})},children:"\u521b\u5efa\u8003\u52e4\u7ec4"})}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.setState({showType:4})},children:"\u521b\u5efa\u8003\u52e4\u73ed\u6b21"})}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.attendanceSchedule()},children:"\u8fdb\u884c\u8003\u52e4\u6392\u73ed"})}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.setState({showType:5})},children:"\u4e0a\u4f20\u6253\u5361\u8bb0\u5f55"})}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.attendanceList()},children:"\u67e5\u770b7\u5929\u5185\u6253\u5361\u7ed3\u679c"})}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{type:"primary",onClick:function(){return e.leaveStatus()},children:"\u67e5\u770b7\u5929\u5185\u8bf7\u5047\u72b6\u6001"})})]}),5===this.state.showType&&Object(g.jsx)("div",{children:Object(g.jsx)(Y,{title:"\u4e0a\u4f20\u6253\u5361\u8bb0\u5f55",onClick:function(t){return e.uploadRecord(t)}})}),4===this.state.showType&&Object(g.jsx)("div",{children:Object(g.jsx)(T,{title:"\u521b\u5efa\u8003\u52e4\u73ed\u6b21",onClick:function(t){return e.createShift(t)}})}),3===this.state.showType&&Object(g.jsx)("div",{children:Object(g.jsx)(v,{title:"\u521b\u5efa\u8003\u52e4\u7ec4",onClick:function(t){return e.createGroup(t)}})}),1===this.state.showType&&Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:Object(g.jsx)("button",{type:"button",onClick:function(){return e.back()},children:"\u8fd4\u56de"})}),Object(g.jsx)("h3",{children:"\u6253\u5361\u8bb0\u5f55\uff1a"}),this.state.recordList.length>0&&this.state.recordList.map((function(t,a){return Object(g.jsx)("div",{children:Object(g.jsxs)("div",{children:["\u5de5\u4f5c\u65e5\uff1a",function(){return e.getDate(new Date(t.workDate))},Object(g.jsx)("br",{}),"\u6253\u5361\u65f6\u95f4\uff1a",function(){return e.getDate(new Date(t.userCheckTime))}]})},a)})),0===this.state.recordList.length&&Object(g.jsx)("div",{children:"\u6682\u65e07\u5929\u5185\u6253\u5361\u8bb0\u5f55\uff0c\u8bd5\u8bd5\u5728\u9489\u9489\u8003\u52e4\u4e2d\u6253\u5361"})]}),2===this.state.showType&&Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:Object(g.jsx)("button",{type:"button",onClick:function(){return e.back()},children:"\u8fd4\u56de"})}),Object(g.jsx)("h3",{children:"\u8bf7\u5047\u72b6\u6001\uff1a"}),this.state.leaveList.length>0&&this.state.leaveList.map((function(t,a){return Object(g.jsx)("div",{children:Object(g.jsxs)("div",{children:["\u5f00\u59cb\u65f6\u95f4\uff1a",function(){return e.getDate(new Date(t.startTime))},Object(g.jsx)("br",{}),"\u7ed3\u675f\u65f6\u95f4\uff1a",function(){return e.getDate(new Date(t.endTime))},Object(g.jsx)("br",{}),"\u8bf7\u5047\u65f6\u957f\uff1a",function(){return e.getLeaveTime(e.durationPercent,t.durationUnit)},Object(g.jsx)("br",{})]})},a)})),0===this.state.leaveList.length&&Object(g.jsx)("div",{children:"\u6682\u65e07\u5929\u5185\u8bf7\u5047\u8bb0\u5f55"})]})]})]})}},{key:"back",value:function(){this.setState({showType:0})}},{key:"getLeaveTime",value:function(e,t){return e+e}},{key:"getDate",value:function(e){return e.getYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"   "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}},{key:"leaveStatus",value:function(){var e=this,t=this.state.leaveInfo;t.userIdList=this.state.userId,j.a.post(this.state.domain+"/attendance/leaveStatus",JSON.stringify(t),{headers:{"Content-Type":"application/json"}}).then((function(t){t&&t.data.success?t.data.data&&e.setState({leaveList:t.data.data,showType:2}):alert("leaveStatus failed ---\x3e"+JSON.stringify(t))})).catch((function(e){alert("leaveStatus err, "+JSON.stringify(e))}))}},{key:"attendanceList",value:function(){var e=this,t=this.state.query;t.userIdList.push(this.state.userId),j.a.post(this.state.domain+"/attendance/attendanceList",JSON.stringify(t),{headers:{"Content-Type":"application/json"}}).then((function(t){t&&t.data.success?t.data.data&&e.setState({recordList:t.data.data,showType:1}):alert("attendanceList failed ---\x3e"+JSON.stringify(t))})).catch((function(e){alert("attendanceList err, "+JSON.stringify(e))}))}},{key:"uploadRecord",value:function(e){var t=this,a=e.deviceName,n=e.time,i=this.state.record;i.userId=this.state.userId,i.deviceName=a,i.time=n,j.a.post(this.state.domain+"/attendance/uploadRecord",JSON.stringify(i),{headers:{"Content-Type":"application/json"}}).then((function(e){e&&e.data.success?e.data.data.success&&(alert("\u4e0a\u4f20\u6253\u5361\u6210\u529f\uff01"),t.back()):alert("uploadRecord failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("uploadRecord err, "+JSON.stringify(e))}))}},{key:"attendanceSchedule",value:function(){var e=this.state.scheduleInfo;e.userId=this.state.userId,e.groupId=this.state.groupId;var t={shiftId:this.state.shiftId,userid:this.state.userId,workDate:(new Date).getTime()};e.schedules.push(t),j.a.post(this.state.domain+"/attendance/attendanceSchedule",JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).then((function(e){e&&e.data.success?e.data.data.success&&alert("\u6392\u73ed\u6210\u529f\uff01\u53ef\u8fdb\u5165oa\u540e\u53f0\u67e5\u770b\u8003\u52e4\u6392\u73ed"):alert("attendanceSchedule failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("attendanceSchedule err, "+JSON.stringify(e))}))}},{key:"createShift",value:function(e){var t=this,a=e.shiftName,n=e.beginTime,i=e.endTime,s=this.state.shiftData;s.userId=this.state.userId,s.groupId=this.state.groupId,s.shiftName=a,s.beginTime=n,s.endTime=i,j.a.post(this.state.domain+"/attendance/createShift",JSON.stringify(s),{headers:{"Content-Type":"application/json"}}).then((function(e){e&&e.data.success?e.data.data&&(t.setState({shiftId:e.data.data.id}),alert("\u521b\u5efa\u73ed\u6b21\u6210\u529f\uff01\u53ef\u8fdb\u5165oa\u540e\u53f0\u67e5\u770b\u8003\u52e4\u6392\u73ed"),t.back()):alert("createShift failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("createShift err, "+JSON.stringify(e))}))}},{key:"createGroup",value:function(e){var t=this,a=e.name,n=e.title,i=e.address,s=e.latitude,c=e.longitude,r=this.state.groupData;r.userId=this.state.userId,r.name=a,r.positions[0].title=n,r.positions[0].latitude=s,r.positions[0].longitude=c,r.positions[0].address=i,j.a.post(this.state.domain+"/attendance/createGroup",JSON.stringify(r),{headers:{"Content-Type":"application/json"}}).then((function(e){e&&e.data.success?e.data.data&&(t.setState({groupId:e.data.data.id}),alert("\u521b\u5efa\u8003\u52e4\u7ec4\u6210\u529f\uff01\u53ef\u8fdb\u5165oa\u540e\u53f0\u67e5\u770b\u8003\u52e4\u7ec4"),t.back()):alert("createGroup failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("createGroup err, "+JSON.stringify(e))}))}},{key:"login",value:function(){var e=this;j.a.get(this.state.domain+"/getCorpId").then((function(t){t.data&&e.loginAction(t.data)})).catch((function(e){alert("corpId err, "+JSON.stringify(e))}))}},{key:"loginAction",value:function(e){var t=this;u.runtime.permission.requestAuthCode({corpId:e,onSuccess:function(e){t.state.authCode=e.code,j.a.get(t.state.domain+"/login?authCode="+t.state.authCode).then((function(e){if(e&&e.data.success){var a=e.data.data.userId,n=e.data.data.userName;alert("\u767b\u5f55\u6210\u529f\uff0c\u4f60\u597d"+n),setTimeout((function(){t.setState({userId:a,userName:n})}),0)}else alert("login failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("httpRequest failed ---\x3e"+JSON.stringify(e))}))},onFail:function(e){alert("requestAuthCode failed ---\x3e"+JSON.stringify(e))}})}}]),a}(i.a.Component),k=(a(614),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,620)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),i(e),s(e),c(e)}))});c.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(N,{})}),document.getElementById("root")),k()}},[[615,1,2]]]);
//# sourceMappingURL=main.561ded8f.chunk.js.map